<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
    <!-- Basic Page Needs -->
    <meta charset="utf-8">
    <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
    <title>labelle</title>

    <meta name="author" content="themesflat.com">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Theme Style -->
    <link rel="stylesheet" type="text/css" href="/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/css/animation.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <!-- image cropping and saving -->
    <link href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.css" rel="stylesheet">

    <style>
        .upload-container {
            display: flex;
            justify-content: space-between;
        }

        .upload-column {
            width: 30%;
            text-align: center;
            border: 2px dashed #ccc;
            padding: 20px;
            cursor: pointer;
        }

        .upload-column input {
            display: none;
        }

        .upload-column label {
            cursor: pointer;
        }

        #cropperModal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
        }

        .image-container {
            max-height: 500px;
            overflow: hidden;
        }

        .image-container img {
            max-width: 100%;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        #preview-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .preview-image {
            width: 30%;
            border: 1px solid #ddd;
        }

        /* Button container styling */
        .button-container {
            display: flex;
            gap: 10px;
            /* Adds space between buttons */
        }

        /* Button styling */
        button {
            padding: 10px 20px;
            background-color: #faea5a;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        /* Hover effect for all buttons */
        button:hover {
            background-color: #fbb710;
        }

        /* Close button specific styling */
        #closeModalButton {
            background-color: #4A4A4A
        }

        #closeModalButton:hover {
            background-color: rgb(109, 107, 107);
        }
        .error-message {
  color: red;
  font-size: 0.8em;
  margin-top: 5px;
  margin-bottom: 10px;
  padding: 5px;
  background-color: #ffeeee;
  border: 1px solid red;
  border-radius: 4px;
}

        
                                    .preview-container {
                                        display: flex;
                                        gap: 10px;
                                        margin-top: 20px;
                                    }

                                    .preview-image {
                                        max-width: 150px;
                                        max-height: 150px;
                                        object-fit: cover;
                                    }

                                    .upload-container {
                                        display: flex;
                                        gap: 20px;
                                        margin-bottom: 20px;
                                    }

                                    .upload-column {
                                        flex: 1;
                                        text-align: center;
                                    }

                                    .upload-column label {
                                        cursor: pointer;
                                        padding: 20px;
                                        border: 2px dashed #ccc;
                                        border-radius: 8px;
                                        display: block;
                                    }

                                    .upload-column input[type="file"] {
                                        display: none;
                                    }
                                
    </style>

    <!-- Font -->
    <link rel="stylesheet" href="/font/fonts.css">

    <!-- Icon -->
    <link rel="stylesheet" href="/icon/style.css">

    <!-- Favicon and Touch Icons  -->
    <link rel="icon" href="/img/core-img/favicon.ico">


</head>

<body class="body">

    <!-- #wrapper -->
    <div id="wrapper">
        <!-- #page -->
        <div id="page" class="">
            <!-- layout-wrap -->
           <div class="layout-wrap">
                <div class="section-menu-left">
                    <div class="box-logo">
                        <a href="/admin/dashboard" id="site-logo-inner">
                            <img class="" style="height: 97px;" alt="" src="/img/core-img/logo.png" data-light="/images/logo/logo.png" data-dark="/images/logo/logo-dark.png" >
                        </a>
                        <div class="button-show-hide">
                            <i class="icon-menu-left"></i>
                        </div>
                    </div>
                    <div class="center">
                        <div class="center-item">
                            <div class="center-heading">Main Home</div>
                            <ul class="menu-list">
                                <li class="menu-item has-children ">
                                    <a href="/admin/dashboard" class="menu-item-button">
                                        <div class="icon"><i class="icon-grid"></i></div>
                                        <div class="text">Dashboard</div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="center-item">
                            <div class="center-heading">All page</div>
                            <ul class="menu-list">
                                <li class="menu-item has-children active">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="icon-shopping-cart"></i></div>
                                        <div class="text">Ecommerce</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/add-product" class="">
                                                <div class="text">Add Product</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/product-list" class="">
                                                <div class="text">Product List</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="menu-item has-children">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="icon-layers"></i></div>
                                        <div class="text">Category</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/fragrance-list" class="">
                                                <div class="text">Fragrance List</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/add-fragrance" class="">
                                                <div class="text">Add Fragrance Type</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/occasion-list" class="">
                                                <div class="text">Occasion List</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/add-occasion" class="">
                                                <div class="text">Add Occasion</div>
                                            </a>
                                        </li>
                                         <li class="sub-menu-item">
                                            <a href="/admin/milliliters-list" class="">
                                                <div class="text">Milliliters List</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/add-milliliters" class="">
                                                <div class="text">Add Milliliter</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="menu-item has-children">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="icon-file-plus"></i></div>
                                        <div class="text">Order</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/order-list" class="">
                                                <div class="text">Order list</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="menu-item has-children">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="icon-user"></i></div>
                                        <div class="text">User</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/all-user" class="">
                                                <div class="text">All user</div>
                                            </a>
                                        </li>
                                        
                                    </ul>
                                </li>
                                
                                <li class="menu-item has-children">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="fa fa-ticket"></i></div>
                                        <div class="text">Coupon</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/add-coupon" class="">
                                                <div class="text">Add coupon</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/coupons-list" class="">
                                                <div class="text">coupon List</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="menu-item has-children">
                                    <a href="javascript:void(0);" class="menu-item-button">
                                        <div class="icon"><i class="fa fa-gift"></i></div>
                                        <div class="text">Offer</div>
                                    </a>
                                    <ul class="sub-menu">
                                        <li class="sub-menu-item">
                                            <a href="/admin/offers-list" class="">
                                                <div class="text">Product Offer List</div>
                                            </a>
                                        </li>
                                        <li class="sub-menu-item">
                                            <a href="/admin/category-offer-list" class="">
                                                <div class="text">Category Offer List</div>
                                            </a>
                                        </li>
                                    </ul>

                                </li>
                            </ul>
                        </div>
                       
                <form action="/admin/logout" method="GET">
                    <button type="submit" style='background-color: #fbb710; font-size: 15px; padding: 9px 15px; border-radius: 8px; text-align: center;margin-left: 60px;  cursor: pointer;'>Logout</button>
                  </form>
                  
                
                    </div>
                </div>
                
                <!-- /section-menu-left -->
                <!-- section-content-right -->
                <div class="section-content-right">
                    <!-- header-dashboard -->
                    <div class="header-dashboard">
                        <div class="wrap">
                            <div class="header-left">
                                <a href="/admin/dashboard">
                                    <img class="" id="logo_header_mobile" alt="" src="/images/logo/logo.png"
                                        data-light="/images/logo/logo.png" data-dark="/images/logo/logo-dark.png"
                                        data-width="154px" data-height="52px" data-retina="/images/logo/logo@2x.png">
                                </a>
                                <div class="button-show-hide">
                                    <i class="icon-menu-left"></i>
                                </div>

                            </div>
                            <div class="header-grid">

                                <div class="header-item button-dark-light">
                                    <i class="icon-moon"></i>
                                </div>
                                <div class="header-item button-zoom-maximize">
                                    <div class="">
                                        <i class="icon-maximize"></i>
                                    </div>
                                </div>

                                <div class="popup-wrap user type-header">
                                    <div class="dropdown">
                                        <button class="btn btn-secondary dropdown-toggle" type="button"
                                            id="dropdownMenuButton3" data-bs-toggle="dropdown" aria-expanded="false">
                                            <span class="header-user wg-user">

                                                <span class="flex flex-column">
                                                    <span class="body-title mb-2">Sayyida Jahan</span>
                                                    <span class="text-tiny">Admin</span>
                                                </span>
                                            </span>
                                        </button>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /header-dashboard -->
                    <!-- main-content -->
                    <div class="main-content">
                        <!-- main-content-wrap -->
                        <div class="main-content-inner">
                            <!-- main-content-wrap -->
                            <div class="main-content-wrap">
                                <div class="flex items-center flex-wrap justify-between gap20 mb-27">
                                    <h3>Add Product</h3>
                                    <ul class="breadcrumbs flex items-center flex-wrap justify-start gap10">
                                        <li>
                                            <a href="/admin/dashboard">
                                                <div class="text-tiny">Dashboard</div>
                                            </a>
                                        </li>
                                        <li>
                                            <i class="icon-chevron-right"></i>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <div class="text-tiny">Ecommerce</div>
                                            </a>
                                        </li>
                                        <li>
                                            <i class="icon-chevron-right"></i>
                                        </li>
                                        <li>
                                            <div class="text-tiny">Add product</div>
                                        </li>
                                    </ul>
                                </div>
                                <form class="tf-section-2 form-add-product" action="/admin/add-product" method="POST"
                                enctype="multipart/form-data" id="productForm">
                                <div class="wg-box">
                                    <fieldset class="name">
                                        <div class="body-title mb-10">Product name <span class="tf-color-1">*</span></div>
                                        <input class="mb-10" type="text" placeholder="Enter product name"
                                            name="name" id="name" aria-required="true"
                                            value="<%= formData && formData.name ? formData.name : '' %>">
                                            <% if (locals.errors && errors.name) { %>
                                                <div class="error-message" style="color: red;">
                                                    <%= errors.name %>
                                                </div>
                                            <% } %>
                                    </fieldset>
                                    <div class="gap22 cols">
                                        <fieldset class="category">
                                            <label for="fragranceType" class="body-title mb-10">Fragrance Type<span class="tf-color-1">*</span></label>
                                            <div class="select">
                                                <select class="" name="fragranceType" id="fragranceType" >
                                                    <option value="">Select Fragrance</option>
                                                    <% fragrances.forEach( f=> { %>
                                                        <option value="<%= f.name %>" 
                                                            <%= formData && formData.fragranceType === f.name ? 'selected' : '' %>>
                                                            <%= f.name %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <% if (errors && errors.fragranceType) { %>
                                                    <div class="error-message"><%= errors.fragranceType %></div>
                                                <% } %>
                                            </div>
                                        </fieldset>
                                        <fieldset class="male">
                                            <label for="gender" class="body-title mb-10">Gender<span class="tf-color-1">*</span></label>
                                            <div class="select">
                                                <select class="" id="gender" name="gender" >
                                                    <option value="">Select Gender</option>
                                                    <option value="Male" <%= formData && formData.gender === 'Male' ? 'selected' : '' %>>Male</option>
                                                    <option value="Female" <%= formData && formData.gender === 'Female' ? 'selected' : '' %>>Female</option>
                                                    <option value="Other" <%= formData && formData.gender === 'Other' ? 'selected' : '' %>>Other</option>
                                                </select>
                                                <% if (errors && errors.gender) { %>
                                                    <div class="error-message"><%= errors.gender %></div>
                                                <% } %>
                                            </div>
                                        </fieldset>
                                    </div>
                                    <fieldset class="brand">
                                        <label for="occasions" class="body-title mb-10">Occasions<span class="tf-color-1">*</span></label>
                                        <div class="select">
                                            <select id="occasions" name="occasions">
                                                <option value="">Select Occasion</option>
                                                <% occasions.forEach( f=> { %>
                                                    <option value="<%= f.name %>"
                                                        <%= formData && formData.occasions === f.name ? 'selected' : '' %>>
                                                        <%= f.name %>
                                                    </option>
                                                <% }); %>
                                            </select>
                                            <% if (errors && errors.occasions) { %>
                                                <div class="error-message"><%= errors.occasions %></div>
                                            <% } %>
                                        </div>
                                    </fieldset>
                                    <fieldset class="description">
                                        <div class="body-title mb-10">Description <span class="tf-color-1">*</span></div>
                                        <textarea class="mb-10" id="description" name="description"
                                            placeholder="Description" tabindex="0" aria-required="true"
                                           ><%= formData && formData.description ? formData.description : '' %></textarea>
                                        <% if (errors && errors.description) { %>
                                            <div class="error-message"><%= errors.description %></div>
                                        <% } %>
                                    </fieldset>
                                </div>
                                <div class="wg-box">
                                    <fieldset>
                                        <div class="upload-container">
                                            <div class="upload-column">
                                                <label for="image1">
                                                    <span class="icon">📤</span><br>
                                                    <span class="text">Image 1 (Click to Upload)</span>
                                                    <input type="file" id="image1" name="images" accept="image/*"
                                                        required onchange="handleImageUpload(event, 1)">
                                                </label>
                                            </div>
                                            <div class="upload-column">
                                                <label for="image2">
                                                    <span class="icon">📤</span><br>
                                                    <span class="text">Image 2 (Click to Upload)</span>
                                                    <input type="file" id="image2" name="images" accept="image/*"
                                                        required onchange="handleImageUpload(event, 2)">
                                                </label>
                                            </div>
                                            <div class="upload-column">
                                                <label for="image3">
                                                    <span class="icon">📤</span><br>
                                                    <span class="text">Image 3 (Click to Upload)</span>
                                                    <input type="file" id="image3" name="images" accept="image/*"
                                                        required onchange="handleImageUpload(event, 3)">
                                                </label>
                                            </div>
                                        </div>
                                        <% if (errors && errors.images) { %>
                                            <div class="error-message"><%= errors.images %></div>
                                        <% } %>
                            
                                        <!-- Preview Container -->
                                        <div id="preview-container" class="preview-container"></div>
                            
                                        <div class="body-text">
                                           
                                            <fieldset class="name">
                                                <div class="body-title mb-10">Product Date</div>
                                                <div class="select">
                                                    <input 
                                                        type="date" 
                                                        name="date" 
                                                        value="<%= new Date().toISOString().split('T')[0] %>" 
                                                        readonly>
                                                </div>
                                            </fieldset>
                                            
                                        </div>
                                        <div class="cols gap10">
                                            <button style="margin-top: 330px;" class="tf-button w-full" type="submit" id="addProductBtn">Add product</button>
                                        </div>
                                    </fieldset>
                                </div>
                            </form>
                                <script>
                                 document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('productForm');
    const addProductBtn = document.getElementById('addProductBtn');
    const nameInput = document.getElementById('name');
    const fragranceTypeSelect = document.getElementById('fragranceType');
    const genderSelect = document.getElementById('gender');
    const occasionsSelect = document.getElementById('occasions');
    const descriptionTextarea = document.getElementById('description');
    const imageInputs = document.querySelectorAll('input[type="file"][name="images"]');

    const createErrorElement = (id) => {
        const errorDiv = document.createElement('div');
        errorDiv.id = id;
        errorDiv.className = 'error-message';
        errorDiv.style.color = 'red';
        return errorDiv;
    };

    const nameError = createErrorElement('nameError');
    const fragranceError = createErrorElement('fragranceError');
    const genderError = createErrorElement('genderError');
    const occasionsError = createErrorElement('occasionsError');
    const descriptionError = createErrorElement('descriptionError');
    const imagesError = createErrorElement('imagesError');

    const insertErrorAfter = (input, errorElement) => {
        const existingError = input.parentNode.querySelector('.error-message');
        if (existingError) {
            existingError.remove();
        }
        input.parentNode.insertBefore(errorElement, input.nextSibling);
    };

    const validateName = (name) => {
        if (!name || name.length > 20) {
            nameError.textContent = 'Product name is required and should not exceed 20 characters.';
            insertErrorAfter(nameInput, nameError);
            return false;
        }
        if (/[^a-zA-Z0-9\s-]/.test(name) || name.trim() === '') {
            nameError.textContent = 'Product name should not contain special characters (except -), or be empty';
            insertErrorAfter(nameInput, nameError);
            return false;
        }
        return true;
    };

    const validateFragranceType = (fragranceType) => {
        if (!fragranceType) {
            fragranceError.textContent = 'Please select a fragrance type.';
            insertErrorAfter(fragranceTypeSelect, fragranceError);
            return false;
        }
        return true;
    };

    const validateGender = (gender) => {
        if (!gender) {
            genderError.textContent = 'Please select a gender.';
            insertErrorAfter(genderSelect, genderError);
            return false;
        }
        return true;
    };

    const validateOccasions = (occasions) => {
        if (!occasions) {
            occasionsError.textContent = 'Please select an occasion.';
            insertErrorAfter(occasionsSelect, occasionsError);
            return false;
        }
        return true;
    };

    const validateDescription = (description) => {
        if (!description || description.length > 1000) {
            descriptionError.textContent = 'Description must be under 1000 characters.';
            insertErrorAfter(descriptionTextarea, descriptionError);
            return false;
        }
        return true;
    };

    const validateImages = (imageInputs) => {
        const requiredImageCount = 3;
        const uploadedImages = Array.from(imageInputs).filter(input => input.files.length > 0);
        
        if (uploadedImages.length < requiredImageCount) {
            imagesError.textContent = 'You need to upload exactly 3 images.';
            const uploadContainer = imageInputs[0].closest('.upload-container');
            uploadContainer.parentNode.insertBefore(imagesError, uploadContainer.nextSibling);
            return false;
        }
        return true;
    };

    addProductBtn.addEventListener('click', function(e) {
        [nameError, fragranceError, genderError, occasionsError, descriptionError, imagesError]
            .forEach(errorEl => {
                if (errorEl.parentNode) {
                    errorEl.remove();
                }
            });

        const isNameValid = validateName(nameInput.value);
        const isFragranceTypeValid = validateFragranceType(fragranceTypeSelect.value);
        const isGenderValid = validateGender(genderSelect.value);
        const isOccasionsValid = validateOccasions(occasionsSelect.value);
        const isDescriptionValid = validateDescription(descriptionTextarea.value);
        const areImagesValid = validateImages(imageInputs);

        if (!(isNameValid && isFragranceTypeValid && isGenderValid && 
              isOccasionsValid && isDescriptionValid && areImagesValid)) {
            e.preventDefault();
        }
    });

    form.addEventListener('submit', function(e) {
        const isNameValid = validateName(nameInput.value);
        const isFragranceTypeValid = validateFragranceType(fragranceTypeSelect.value);
        const isGenderValid = validateGender(genderSelect.value);
        const isOccasionsValid = validateOccasions(occasionsSelect.value);
        const isDescriptionValid = validateDescription(descriptionTextarea.value);
        const areImagesValid = validateImages(imageInputs);

        if (!(isNameValid && isFragranceTypeValid && isGenderValid && 
              isOccasionsValid && isDescriptionValid && areImagesValid)) {
            e.preventDefault();
        }
    });
});






function handleImageUpload(event, imageId) {
                                        const file = event.target.files[0];
                                        if (file) {
                                            if (!file.type.startsWith('image/')) {
                                                alert('Please upload only image files.');
                                                event.target.value = '';
                                                return;
                                            }

                                            const reader = new FileReader();
                                            reader.onload = function (e) {
                                                const previewContainer = document.getElementById('preview-container');

                                                const existingPreview = previewContainer.querySelector(`#preview-${imageId}`);
                                                if (existingPreview) {
                                                    existingPreview.remove();
                                                }

                                                const previewImg = document.createElement('img');
                                                previewImg.src = e.target.result;
                                                previewImg.id = `preview-${imageId}`;
                                                previewImg.classList.add('preview-image');
                                                previewContainer.appendChild(previewImg);

                                                uploadedImages[imageId] = true;

                                                checkAllImagesUploaded();
                                            };
                                            reader.readAsDataURL(file);
                                        }
                                    }
</script>
                            </div>
                            <!-- /main-content-wrap -->
                        </div>
                        <!-- /main-content-wrap -->
                        <!-- bottom-page -->

                        <!-- /bottom-page -->
                    </div>
                    <!-- /main-content -->
                </div>
                <!-- /section-content-right -->
            </div>
            <!-- /layout-wrap -->
        </div>
        <!-- /#page -->
    </div>
    <!-- /#wrapper -->
    <!-- image cropping and savving -->
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.js"></script>
    <!-- Javascript -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/bootstrap-select.min.js"></script>
    <script src="/js/zoom.js"></script>
    <!-- <script src="/js/switcher.js"></script> -->
    <script src="/js/theme-settings.js"></script>
    <script src="/js/main.js"></script>

</body>

</html>